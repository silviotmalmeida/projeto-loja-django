{# arquivo parcial com o carrinho da sessão #}

{# carregando o suporte a arquivos estáticos #}
{% load static %}

{# carregando o módulo de filtros personalizados #}
{% load customizedFilters %}

{# renderizando a tabela com os itens do carrinho #}
<div class="table-responsive">
    <table class="table">
        {# cabeçalho da tabela #}
        <tr>
            <th class="d-none d-lg-block">Imagem</th>
            <th class="text-center">Produto</th>
            <th class="text-center">Variação</th>
            <th class="text-center">Quantidade</th>
            <th class="text-center">Total</th>
        </tr>

        {# iterando pelos itens do carrinho #}
        {% for item in cart.values %}
        <tr>
            {# imagem #}
            <td class="d-none d-lg-block">
                <img class="cart-img" src="{% get_media_prefix %}{{ item.imagem }}">
            </td>

            {# link do produto #}
            <td class="text-center">
                {# nome do produto #}
                <a href="{% url 'produto:detail' item.slug %}">
                    {{ item.produto_nome }}
                </a>
                {# ícone remover #}
                <a class="ml-3" href="{% url 'produto:removecart' %}?vid={{ item.variacao_id }}">
                    <i class="fas fa-times-circle text-danger" aria-hidden="true"></i>
                </a>
            </td>

            {# nome da variação #}
            <td class="text-center">{{ item.variacao_nome }}</td>

            {# quantidade #}
            <td class="text-center">
                {{ item.qtd }} x

                {# se existir preço promocional, considera-o #}
                {% if item.preco_unitario_promocional %}
                    {{ item.preco_unitario_promocional|currency_format }}

                {# senão, considera o preço #}
                {% else %}                
                    {{ item.preco_unitario|currency_format }}
                {% endif %}
            </td>

            {# total #}
            <td class="text-center">
                {# se existir preço total promocional, considera-o #}
                {% if item.preco_total_promocional %}
                    {{ item.preco_total_promocional|currency_format }}

                {# senão, considera o preço total #}
                {% else %}
                    {{ item.preco_total|currency_format }}
            {% endif %}
            </td>

        </tr>
        {% endfor %}

    </table>
</div>